# brdm88_infra
Dmitry Bredikhin Infrastructure study repository

Homework-5
===========

```
test pin: 6214157507237678334670591556762
```

Конфигурация инфраструктуры: 
	Хост bastion, ext. IP: 35.187.37.55, int. IP: 10.132.0.2
	Хост internal-host-1, int. IP: 10.132.0.3
	
В примерах команд ниже используется имя пользователя brdm88 (мой логин для развернутой для данных задач среды).

##### Задача 1. Исследовать способ подключения к внутреннему хосту в частной сети облака с рабочей машины в одну команду.

В качестве решения можно предложить проксирование SSH. Необходимо задать опцию ProxyCommand, которая установит соединение с "бастионом" и ...
В случае текущей инфраструктуры получаем команду для подключения (случай не первого подключения, когда хосты были уже добавлены в known_hosts):
```
ssh -o ProxyCommand='ssh -W %h:%p brdm88@35.187.37.55' brdm88@10.132.0.3
```


##### Задача 2. Вариант подключения к тому же хосту командой вида ssh internalhost.

Для решения этой задачи зададим псевдонимы в файле ~/.ssh/config на рабочей машине, содержимое файла следующее:

```
Host bastion
    Hostname 35.187.37.55
    IdentityFile ~/.ssh/brdm88

Host internal-host-1
    Hostname 10.132.0.3
    IdentityFile ~/.ssh/brdm88
    ProxyCommand ssh brdm88@bastion nc %h %p 2> /dev/null	
```

В этом случае для *** используется Netсat (nc), так как This option (-W) was added in OpenSSH 5.4 # ssh -V

С такой конфигурацией возможно подключиться к хосту с внутренним адресом 10.132.0.3 командой:
``` ssh brdm88@internal-host-1 ```
